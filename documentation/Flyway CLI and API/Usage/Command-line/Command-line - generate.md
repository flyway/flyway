---
pill: cli_generate
subtitle: 'Command-line: generate'
---
# Command-line: generate - Preview

{% include enterprise.html %}

Generates a migration script based on the differences from a flyway diff artifact.
The version, description and location of the migration script can be specified or auto-generated by flyway.
Baseline, versioned and undo script types can be generated.

<img src="assets/command-generate.png" alt="generate">

## Usage

<pre class="console"><span>&gt;</span> flyway generate [options]</pre>

## Options

The following options can be provided to the `generate` command in the format -key=value:
- `generate.target` - The target to generate the script for, must be either `diff.source` or `diff.target` from flyway diff. Uses `diff.target` if unspecified.
- `generate.changes` - A comma separated list of change ids. If unspecified, all changes will be used. May specify `-` to read changes from stdin.
- `generate.types` - A comma separated list of script types to generate. Valid values: `versioned|undo|baseline`, Default: `versioned`.
- `generate.version` - The version part of the migration name. If unspecified this will be calculated to be either the next migration version if a versioned migration is specified, or the current version otherwise.
- `generate.description` - The description part of the migration name.
- `generate.baselineFilename` - The filename (or full path) to use for the generated baseline migration. Mutually exclusive with description & version.
- `generate.versionedFilename` - The filename (or full path) to use for the generated versioned migration. Mutually exclusive with description & version.
- `generate.undoFilename` - The filename (or full path) to use for the generated undo migration. Mutually exclusive with description & version.
- `generate.location` - The location to generate the migration to.
- `generate.artifactFilename` - The location of the diff artifact to apply to the target. Defaults: `diff.artifactFilename` or `%temp%/flyway.artifact.diff`.
- `generate.addTimestamp` - Add a timestamp to the calculated version if one is not already present. Default: false`

## Examples

In all examples below the `diff` command must first be run to generate a diff artifact.
This diff artifact contains the changes that will be used to generate migration scripts.

For example, the following command generates a diff between the schema model directory and the shadow environment:
<pre class="console">&gt; flyway diff -diff.source=schemaModel -diff.target=migrations -diff.buildEnvironment=shadow</pre>

### Generating a versioned migration script with auto-generated filename

If the migrations directory has the following contents before running the generate command:
```
B001__baseline.sql
V002.sql
```
Then running the `generate` command will create a new versioned `V003.sql` migration script:
<pre class="console">&gt; flyway generate -outputType=json

Flyway {{ site.flywayVersion }} by Redgate

{
  "output" : [ {
    "location" : "C:\\Users\\FlywayUser\\Project\\migrations\\V003.sql",
    "configPath" : null,
    "includedDependencies" : [ ],
    "messages" : [ ]
  } ]
}
</pre>

Leaving the migrations directory with the following contents:
```
B001__baseline.sql
V002.sql
V003.sql
```

### Generating versioned and undo migration scripts with a specified version and description

If the migrations directory has the following contents before running the generate command:
```
B001__baseline.sql
V002.sql
```
Then running the following `generate` command will generate versioned and undo scripts with the specified version and description:
<pre class="console">&gt; flyway generate -generate.types=versioned,undo -generate.version=003 -generate.description=New-feature

Flyway {{ site.flywayVersion }} by Redgate

Database: jdbc:mysql://clone-internal.red-gate.com:32781/mysql (MySQL 8.0)
Database: jdbc:mysql://clone-internal.red-gate.com:32781/mysql (MySQL 8.0)
Generating undo migration: C:\Users\FlywayUser\Project\migrations\U003__New-feature.sql
Generating versioned migration: C:\Users\FlywayUser\Project\migrations\V003__New-feature.sql
Generated: C:\Users\FlywayUser\Project\migrations\V003__New-feature.sql
Generated: C:\Users\FlywayUser\Project\migrations\U003__New-feature.sql
</pre>

Leaving the migrations directory with the following contents:
```
B001__baseline.sql
V002.sql
U003__New-feature.sql
V003__New-feature.sql
```

### Generating a baseline migration script with a specified filename

In this case the migrations directory will be empty, as the baseline migration is the first script to be generated.
Running the following `generate` command will generate a baseline script at the specified location:
<pre class="console">&gt; flyway generate -generate.types=baseline -generate.baselineFilename=C:\Users\FlywayUser\Project\migrations\B000__initial_state.sql

Flyway {{ site.flywayVersion }} by Redgate

Database: jdbc:mysql://clone-internal.red-gate.com:32781/mysql (MySQL 8.0)
Generating baseline migration: C:\Users\FlywayUser\Project\migrations\B000__initial_state.sql
Generated: C:\Users\FlywayUser\Project\migrations\B000__initial_state.sql
</pre>

Leaving the migrations directory with the following contents:
```
B000__initial_state.sql
```

### Generating an undo migration script for an existing versioned migration

If the migrations directory has the following contents before running the generate command:
```
B001__baseline.sql
V002_20240828161524__New_Feature.sql
```
Then running the following `generate` command will generate a corresponding undo script for the `V002` migration, but only containing the changes for the comma separated change Ids specified in the `changes.txt` file:
<pre class="console">&gt; flyway generate -generate.types=undo -changes='-' -outputType=json < changes.txt

Flyway {{ site.flywayVersion }} by Redgate

{
  "output" : [ {
    "location" : "C:\\Users\\FlywayUser\\Project\\migrations\\U002_20240828161524__New_Feature.sql",
    "configPath" : null,
    "includedDependencies" : [ ],
    "messages" : [ {
      "type" : "Warning",
      "warningCode" : null,
      "message" : "Line 9: [ColumnDrop] This deployment drops the column sakila.inventory.new_column. Any data in the column will be lost."
    } ]
  } ]
}
</pre>

Leaving the migrations directory with the following contents:
```
B001__baseline.sql
U002_20240828161524__New_Feature.sql
V002_20240828161524__New_Feature.sql
```

Note:
 - Specifying `-generate.types=baseline,versioned` or `-generate.types=baseline,undo` is disallowed and will result in an error.
 - `generate.target` must be either `diff.source` or `diff.target`.
 - A valid diff artifact must exist for the generate command to successfully generate migration scripts.
